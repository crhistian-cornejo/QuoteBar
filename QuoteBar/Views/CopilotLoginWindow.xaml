<Window
    x:Class="QuoteBar.Views.CopilotLoginWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Sign in to GitHub Copilot">

    <Grid Background="#0d1117" Padding="32">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Spacing="16" HorizontalAlignment="Center">
            <!-- GitHub Logo -->
            <FontIcon 
                Glyph="&#xEBDA;" 
                Foreground="#c9d1d9" 
                FontSize="48"
                HorizontalAlignment="Center"/>
            
            <TextBlock 
                Text="Sign in to GitHub Copilot" 
                FontSize="24" 
                FontWeight="SemiBold" 
                Foreground="White"
                HorizontalAlignment="Center"/>
        </StackPanel>

        <!-- Main content -->
        <StackPanel Grid.Row="1" Spacing="24" Margin="0,32,0,0">
            <!-- Step 1: User code -->
            <Border 
                x:Name="CodePanel"
                Background="#161b22" 
                CornerRadius="12" 
                Padding="24"
                Visibility="Collapsed">
                <StackPanel Spacing="16">
                    <TextBlock 
                        Text="1. Copy this code:" 
                        Foreground="#8b949e"
                        FontSize="14"/>
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <Border 
                            Grid.Column="0"
                            Background="#0d1117" 
                            CornerRadius="8" 
                            Padding="16,12"
                            BorderBrush="#30363d"
                            BorderThickness="1">
                            <TextBlock 
                                x:Name="UserCodeText"
                                Text="XXXX-XXXX" 
                                FontSize="28" 
                                FontWeight="Bold" 
                                Foreground="#58a6ff"
                                FontFamily="Consolas"
                                HorizontalAlignment="Center"
                                IsTextSelectionEnabled="True"/>
                        </Border>
                        
                        <Button 
                            x:Name="CopyCodeButton"
                            Grid.Column="1"
                            Content="Copy"
                            Click="OnCopyCodeClick"
                            Margin="12,0,0,0"
                            Padding="16,12"
                            Background="#238636"
                            Foreground="White"
                            CornerRadius="8"/>
                    </Grid>
                    
                    <TextBlock 
                        Text="2. Then click below to open GitHub:" 
                        Foreground="#8b949e"
                        FontSize="14"/>
                    
                    <Button
                        x:Name="VerifyLink"
                        Content="Open GitHub Device Verification"
                        Click="OnVerifyLinkClick"
                        FontSize="16"
                        Foreground="#58a6ff"
                        Background="Transparent"
                        BorderThickness="0"
                        Padding="0"
                        HorizontalAlignment="Center"/>
                    
                    <TextBlock 
                        Text="3. Paste the code and authorize access" 
                        Foreground="#8b949e"
                        FontSize="14"/>
                </StackPanel>
            </Border>

            <!-- Loading state -->
            <StackPanel
                x:Name="LoadingPanel"
                Visibility="Visible"
                HorizontalAlignment="Center"
                Spacing="16">
                <FontIcon
                    x:Name="LoadingSpinner"
                    Glyph="&#xE72C;"
                    Foreground="#58a6ff"
                    FontSize="32"/>
                <TextBlock
                    x:Name="LoadingText"
                    Text="Requesting device code..."
                    Foreground="#8b949e"
                    HorizontalAlignment="Center"/>
            </StackPanel>

            <!-- Waiting for authorization -->
            <Border
                x:Name="WaitingPanel"
                Background="#1c2128"
                CornerRadius="8"
                Padding="16"
                Visibility="Collapsed">
                <StackPanel Orientation="Horizontal" Spacing="12" HorizontalAlignment="Center">
                    <FontIcon
                        x:Name="WaitingSpinner"
                        Glyph="&#xE72C;"
                        Foreground="#58a6ff"
                        FontSize="16"/>
                    <TextBlock
                        Text="Waiting for you to authorize on GitHub..."
                        Foreground="#8b949e"
                        VerticalAlignment="Center"/>
                </StackPanel>
            </Border>

            <!-- Success state -->
            <Border 
                x:Name="SuccessPanel"
                Background="#238636" 
                CornerRadius="8" 
                Padding="16"
                Visibility="Collapsed">
                <StackPanel Orientation="Horizontal" Spacing="12" HorizontalAlignment="Center">
                    <FontIcon Glyph="&#xE73E;" Foreground="White" FontSize="20"/>
                    <TextBlock 
                        Text="Successfully connected to GitHub Copilot!" 
                        Foreground="White"
                        FontWeight="SemiBold"
                        VerticalAlignment="Center"/>
                </StackPanel>
            </Border>

            <!-- Error state -->
            <Border 
                x:Name="ErrorPanel"
                Background="#da3633" 
                CornerRadius="8" 
                Padding="16"
                Visibility="Collapsed">
                <StackPanel Spacing="8">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <FontIcon Glyph="&#xEA39;" Foreground="White" FontSize="16"/>
                        <TextBlock 
                            x:Name="ErrorText"
                            Text="An error occurred" 
                            Foreground="White"
                            VerticalAlignment="Center"/>
                    </StackPanel>
                    <Button 
                        x:Name="RetryButton"
                        Content="Try Again"
                        Click="OnRetryClick"
                        Background="#161b22"
                        Foreground="White"
                        HorizontalAlignment="Left"/>
                </StackPanel>
            </Border>
        </StackPanel>

        <!-- Spacer -->
        <Grid Grid.Row="2"/>

        <!-- Footer -->
        <StackPanel Grid.Row="3" Spacing="16">
            <TextBlock 
                Text="This will allow QuoteBar to read your Copilot usage statistics." 
                Foreground="#8b949e"
                FontSize="12"
                TextWrapping="Wrap"
                HorizontalAlignment="Center"
                TextAlignment="Center"/>
            
            <Button 
                x:Name="CancelButton"
                Content="Cancel"
                Click="OnCancelClick"
                Background="Transparent"
                Foreground="#8b949e"
                HorizontalAlignment="Center"
                Padding="24,8"/>
        </StackPanel>
    </Grid>
</Window>
